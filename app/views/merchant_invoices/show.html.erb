<h1>Invoice #<%= @invoice.id %></h1>

<p>Status: <%= @invoice.status %></p>
<p>Date Created: <%= @invoice.created_at_formatted %></p>
<p>Total Revenue: <%= number_to_currency(@invoice.total_revenue) %></p>
<p>Customer Name: <%= @invoice.customer_by_id.first_name %> <%= @invoice.customer_by_id.last_name %></p>

<table style="text-align:center">
  <tr>
    <th>Item Name</th>
    <th>Quantity</th>
    <th>Unit Price</th>
    <th>Status</th>
  </tr>
  <% @invoice.items.each do |item| %>
    <div id="table-<%= item.id %>">
      <tr>
        <td><%= item.name %></td>
        <td><%= @invoice.item_quantity(item.id) %></td>
        <td><%= number_to_currency(@invoice.item_unit_price(item.id)) %></td>
        <td><%= form_with url: invoice_item_path(invoice_item_id: item.invoice_item_by_id(@invoice.id).id, merchant_id: item.merchant.id), method: :patch, local: true do |f| %>
              <%= f.select :ii_status, ["pending", "packaged", "shipped"], value: item.invoice_item_by_id(@invoice.id).status %>
              <%= f.submit 'Update Item Status' %>
            <% end %> </td>
      </tr>
    </div>
  <% end %>
</table>
